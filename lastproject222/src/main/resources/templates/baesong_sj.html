<th:block th:include="main.html"></th:block>
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<!-- 머티리얼 라이즈 css파일 -->

<style type="text/css">
html, body {
	width: 100%;
	height: 100%;
	font-family: 나눔고딕;
}

html .pullheight {
	margin-bottom: 60%;
}

.mainmar {
	margin-top: 5%;
}

.sidenav {
	padding-bottom: 40px;
	padding-top: 40px;
}

.user-view {
	padding-bottom: 80px;
}

.border1 {
	/* 	border: 1px solid; */
	border-color: #90a4ae;
	margin-bottom: 11px;
}

.list_img {
	width: 200px;
	height: auto;
}

img {
	width: 100%;
}

#baesong_sj {
	padding-left: 20px;
}

th {
	text-align: center;
}
</style>
</head>
<body>
	<div class="container">
		<!-- 수정, 삭제 둘다 보여주는 창/ 수정->insert.html파일에 입력내용 그대로 가져가기, 삭제 모달창 띄워서 삭제하기 -->
		<div class="row">
			<!-- 배너  -->
			<div class="col s3 pullheight grey lighten-5">
				<ul id="slide-out" class=" center-align">
					<li><div class="user-view">
							<a href="#name"><span class="black-text name">감자탕 만드는
									남자</span></a><br> <br> <a href="#user"><img class="circle"
								src="image/a.jpg"></a><br> <br> <br>
							<div>
								<span class="black-text ">안녕하세요 감만남 민성 입니다.</span>
							</div>

						</div></li>
					<li class="border1"><a class="red-text bold" href="#!"><i
							class="material-icons">favorite_border</i>내 단골 상점에 추가하기</a></li>
					<li class="border1"><a class="black-text" href="#!">판매목록
							보기</a></li>
					<li class="border1"><a class="black-text"
						href="sjTimeLine.html">담벼락(공지사항) 보기</a></li>
					<li class="border1"><a class="black-text" href="#!">후기남기기</a></li>
					<li class="border1"><a class="black-text" href="#!">배송관리</a></li>
					<!-- 관리자 아이디로 로그인시 상품 보이게  -->
					
					<li class="border1"><a class="black-text"
						href="product_insert.html">상품등록</a></li>
					<li class="border1"><a class="black-text"
						href="product_getList_sj.html">상품관리</a></li>
					<li><div class="divider paddingup200"></div></li>
					<li><a class="subheader">감자탕을 만드는 남자</a></li>
					<li><a class="waves-effect" href="#!">copyright-민성민성</a></li>
				</ul>
			</div>
			<div class="col s9" id="baesong_sj">

				<table class="centered mainmar">
					<tr>
						<th>주문번호</th>
						<th>상품명</th>
						<th>가격</th>
						<th>주문날짜</th>
						<!--재고수량이 5개 이상일 경우 ->"재고수량이 5개이하입니다. 삭제하시겠습니까?" 추가 -->
						<th>배송확인</th>
					</tr>
					<tr th:each="list:${list}" class="listtr">
						<th:block th:each="option:${options}" th:if="${option.optionseq}==${list.optionseq}">
						<td th:text="${list.bucketseq}"></td>
						<td th:text="${list.itemname}"></td>
						<td th:text="(${list.price}*${list.quantity}+
						${option.optionprice}*${list.quantity}-${list.discount}*${list.quantity}+2500+'원')"></td>
						
						<td >2018-03-04</td>
						<input th:if="${list.condition}!='cancel'" type="hidden" th:value="${list.bucketseq}" class="orderseq">
						<td>
							<p th:if="${list.condition}!='cancel'">
								<a class="waves-effect waves-light btn modal-trigger cancelbtn"
									href="#">주문취소(개별통보필수)</a>
							</p>
							<p th:if="${list.condition}=='cancel'">
								취소된 상품
							</p>
							
							<p>
								<a class="waves-effect btn modal-trigger baesongbtn" href="#" th:if="${list.condition}!='cancel'">배송완료</a>
							</p>
						</td>
						</th:block>
					</tr>
				</table>
		<input type="hidden"  th:value="${ordersize[0]}" class="size1"></input>
		<input type="hidden"  th:value="${ordersize[1]}" class="size2" ></input>
		
			<div class="col s12 center-align jumoonul">
				<ul class="pagination" >
					<li class="waves-effect"><a href="#!">
					<i class="material-icons larr">chevron_left</i></a></li>
					<li class="page"></li>
					
					
					<li class="waves-effect"><a href="#!">
					<i class="material-icons rarr">chevron_right</i></a></li>
				</ul>
			</div>
			</div>
			
		</div>
		
		<!-- Modal Structure -->
<!-- 		<DIV ID="MODAL1" CLASS="MODAL"> -->
<!-- 			<DIV CLASS="MODAL-CONTENT"> -->
<!-- 				<P>주문번호 :5050-2211</P> -->
<!-- 				<P ID="REMAINSP"></P> -->

<!-- 				주문을 취소하시겠습니까? (개별통보를 필수적으로 해야합니다.) -->
<!-- 			</DIV> -->
<!-- 			<DIV CLASS="MODAL-FOOTER"> -->
<!-- 				<A HREF="#!" CLASS="MODAL-CLOSE WAVES-EFFECT WAVES-GREEN BTN-FLAT CANCELMO">AGREE</A> -->
<!-- 			</DIV> -->
<!-- 		</DIV> -->
	</div>

	<th:block th:include="footer.html"></th:block>
	<script src="http://code.jquery.com/jquery-3.4.1.min.js"></script>
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.js"></script>
	<script>
		$(document).ready(function() {
			$('.modal').modal();
			
			
			if($(".size1").val()!=0){
				var size= $(".size1").val();
				
				var size2= $(".size2").val();
							
				
				for(var i=1;i<size/5+1;i++){
					
					
					var innerHtml1 = '<li class="waves-effect pagenum"><a href="/baesong_sj?pgno='+i+'">'+i+'</a></li>'
					if(i==size2){
					var innerHtml1 = '<li class="waves-effect pagenum active"><a href="/baesong_sj?pgno='+i+'">'+i+'</a></li>'
					}
					
							$('.page').append(innerHtml1);	
				}
				
			}
		
			
		});
		
		$(".cancelbtn").click(function(){
			var index=$(".cancelbtn").index(this);
			var seq=$(".orderseq:eq("+index+")").val();
			var choose=confirm("주문을 취소 하시겠습니까?");
			if(choose){
	 			$.ajax({
				async:true,
				type:'POST',
				data:JSON.stringify(seq),
				url:"/bucconditioncancel",
				dataType : 'json',
				contentType: "application/json; charset=UTF-8",
				success : function(data){
					alert("성공");
				}
				
			});
			}

		});
		
		$(".baesongbtn").click(function(){
			var index=$(".cancelbtn").index(this);
			var seq=$(".orderseq:eq("+index+")").val();
			var choose=confirm("주문을 취소 하시겠습니까?");
			alert(choose);
			if(choose){
	 			$.ajax({
				async:true,
				type:'POST',
				data:JSON.stringify(seq),
				url:"/buccondition",
				dataType : 'json',
				contentType: "application/json; charset=UTF-8",
				success : function(data){
					alert("성공");
				}
				
			});
			}

		});
	</script>
</body>
</html>